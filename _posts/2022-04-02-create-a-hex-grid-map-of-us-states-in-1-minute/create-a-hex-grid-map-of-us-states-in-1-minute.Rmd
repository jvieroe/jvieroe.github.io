---
title: "Create a Hex Grid Map of US States in 1 minute"
description: |
  A short description of the post.
categories:
  - R
  - hexgrid
  - sf
  - ggplot2
author:
  - name: Jeppe Vier√∏
    url: https://twitter.com/jvieroe
date: 2022-04-02
baseurl: https://jvieroe.github.io/
preview: hex_bees.jpg
output:
  distill::distill_article:
    self_contained: false
    code_folding: false
    highlight: default
    highlight_downlit: false
    toc: true
draft: true
twitter:
  site: "@jvieroe"
  creater: "@jvieroe"
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<center>
![Photo by Jez Timms on Unsplash](hex_bees.jpg){width=75%}

</center>


```{r, warning=FALSE, message=FALSE}
library(dplyr)
library(magrittr)
library(sf)
library(ggplot2)
library(shadowtext)


```


xx



```{r, warning=FALSE, message=FALSE}
hex <- read_sf(dsn = "/Users/jeppeviero/Dropbox/us_states_hexgrid",
               layer = "us_states_hexgrid")

```


```{r, warning=FALSE, message=FALSE}
hex <- hex %>% 
  mutate(state = gsub(" \\(United States\\)", "", google_nam)) %>% 
  relocate(state, .before = geometry)


```


```{r, warning=FALSE, message=FALSE}
ggplot() +
  geom_sf(data = hex) +
  theme_void()

```

```{r, warning=FALSE, message=FALSE}
hex <- hex %>% 
  st_transform(crs = 3857)

```

xx



```{r, warning=FALSE, message=FALSE}
ggplot() +
  geom_sf(data = hex) +
  theme_void()

```
```{r, warning=FALSE, message=FALSE}

latitude <- 38
longitude <- -100

ortho <- paste0('+proj=ortho +lat_0=', latitude, ' +lon_0=', longitude,
                ' +x_0=0 +y_0=0 +a=6371000 +b=6371000 +units=m +no_defs')


hex %>% 
  st_transform(ortho) %>% 
  ggplot() +
  geom_sf(data = hex) +
  theme_minimal()

```



```{r, warning=FALSE, message=FALSE}
cents <- hex %>% 
  st_centroid() %>% 
  select(state, iso3166_2)

cents <- cents %>% 
  st_coordinates() %>%
  as.data.frame() %>% 
  tibble() %>% 
  mutate(label = cents$iso3166_2)


```

http://joshuamccrain.com/tutorials/ggplot_maps/maps_tutorial.html

```{r, warning=FALSE, message=FALSE}
ggplot() +
  geom_sf(data = hex, fill = "steelblue1", color = "white", size = .65) +
  geom_shadowtext(data = cents, aes(x = X, y = Y, label = label)) +
  theme_void()

```
```{r, warning=FALSE, message=FALSE}
df <- x

```